10 ' MODEL 100 CALCULATOR
20 ' Version 01.00.00
30 ' Copyright 1983 Tandy Corporation
40 ' All rights reserved
100 CLS
110 PRINT@80,CHR$(27);"p       TRS-80 Model 100 Software        "
120 LINE (0,13)-(239,13)
130 LINE (0,15)-(239,15)
140 LINE (0,25)-(239,25)
150 PRINT @165,CHR$(27);"qModel 100 Calculator  01.00.00 "
160 PRINT
170 PRINT TAB(3);"Copyright 1983  Tandy Corporation"
180 PRINT TAB(10);"All rights reserved";
190 FOR I=1 TO 8
200 KEY I,CHR$(I)
210 NEXT I
220 KEY ON
230 ON KEY GOSUB 21000,22000,23000,23020,24000,25000,,26000
240 ON ERROR GOTO 50000
250 FOR I=1 TO 500
260 IF INKEY$>"" THEN I=500
270 NEXT I
280 GOSUB 40000
1000 ' Branch on next operation
1010 EF=0
1020 GOSUB 40050
1030 ON INSTR("+-*/^="+CHR$(13),OP$) GOTO 2000,3000,4000,5000,6000,9000,9000
2000 ' Addition
2010 GOSUB 10000
2020 A=A+N
2030 GOTO 1000
3000 ' Subtraction
3010 GOSUB 10000
3020 A=A-N
3030 GOTO 1000
4000 ' Multiplication
4010 GOSUB 10000
4020 A=A*N
4030 GOTO 1000
5000 ' Division
5010 GOSUB 10000
5020 IF EF=0 THEN A=A/N
5030 GOTO 1000
6000 ' Exponentiation
6010 GOSUB 10000
6020 A=A^N
6030 GOTO 1000
9000 ' ENTER or =
9010 GOSUB 10000
9020 IF LEN(N$)>0 THEN A=A+N
9030 GOTO 1000
10000 ' Load a number and the next operand
10010 F=0
10020 PRINT @200,TAB(39);
10030 PRINT @200,;
10040 IF OP$>"" AND INSTR("+-*/^",OP$)>0 THEN F=1: PRINT OP$; ELSE PRINT " ";
10050 N=0
10060 N$=""
10070 PRINT ">_";CHR$(8);
10080 A$=INKEY$: IF A$="" THEN 10080
10090 IF INSTR("0123456789.",A$)>0 THEN N$=N$+A$: F=0: PRINT A$;"_";CHR$(8);: GOTO 10080
10100 IF INSTR("+-",A$)>0 AND F=1 THEN F=0: N$=A$: PRINT A$;"_";CHR$(8);: GOTO 10080
10110 ON INSTR(CHR$(8)+CHR$(127)+CHR$(27),A$) GOTO 10140,10180,10190
10120 IF INSTR("+-*/^="+CHR$(13),A$)=0 THEN 10080
10130 N=VAL(N$): OP$=A$: RETURN
10140 IF N$="" THEN 10080
10150 PRINT CHR$(8);"_ ";STRING$(2,8);
10160 N$=LEFT$(N$,LEN(N$)-1)
10170 GOTO 10080
10180 GOTO 10000
10190 EF=1: A=0: N$="": A$="": GOTO 10130
20000 ' Special key functions
21000 ' 1/X
21010 A=1/A: GOTO 40050
22000 ' -X
22010 A=-A: GOTO 40050
23000 ' SQR
23010 A=SQR(A): GOTO 40050
23020 ' X Squared
23030 A=A*A: GOTO 40050
24000 ' LOG
24010 A=LOG(A): GOTO 40050
25000 ' EXP
25010 A=EXP(A): GOTO 40050
26000 ' Exit program
26010 MENU
40000 ' Construct screen
40010 CLS
40020 PRINT CHR$(27);"p      Model 100 Calculator 01.00.00     ";CHR$(27);"q"
40030 IF OP$="" THEN OP$="="
40040 PRINT @280," 1/X  -X  Sqr  X*X  Log  e^x       Exit";
40050 PRINT @120,"Accum =";A;TAB(39)
40060 PRINT @200,;
40070 IF OP$>"" AND INSTR("+-*/^",OP$)>0 THEN PRINT OP$; ELSE PRINT " ";
40080 PRINT ">";
40090 IF N$>"" THEN PRINT N$;
40100 PRINT "_";CHR$(8);
40120 RETURN
50000 ' Error trap
50010 IF ERR=3 THEN RESUME 1000
50020 BEEP
50030 PRINT @208,CHR$(27);"p";
50040 IF ERR=6 THEN PRINT " OVERFLOW or UNDERFLOW ERROR ": GOTO 50070
50050 IF ERR=11 THEN PRINT " DIVISION BY ZERO ": GOTO 50070
50060 PRINT " ERROR";ERR;"IN LINE";ERL;
50070 PRINT CHR$(27);"q";
50080 A$=INKEY$: IF A$<>"" THEN 50080
50090 A$=INKEY$: IF A$="" THEN 50090
50100 IF A$=CHR$(27) THEN ON ERROR GOTO 0
50110 PRINT @200,TAB(39);
50120 RESUME 40030
60000 ' Last line
